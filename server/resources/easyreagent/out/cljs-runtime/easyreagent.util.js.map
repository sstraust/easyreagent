{"version":3,"sources":["easyreagent/util.cljs"],"mappings":"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","names":["easyreagent.util/curr-css","cljs.core.atom","easyreagent.util/reload-stylesheets","c__21496__auto__","cljs.core.async.chan","cljs.core.async.impl.dispatch/run","f__21497__auto__","switch__21451__auto__","state_23676","state_val_23677","inst_23660","inst_23661","inst_23662","cljs.core.async.impl.ioc-helpers/take!","inst_23665","inst_23664","inst_23666","cljs.core/deref","inst_23667","inst_23668","statearr-23678","statearr-23679","statearr-23680","inst_23670","statearr-23681","statearr-23682","inst_23673","inst_23674","statearr-23683","cljs.core.async.impl.ioc-helpers/return-chan","statearr-23684","state-machine__21452__auto__","ret-value__21453__auto__","result__21454__auto__","cljs.core/keyword-identical?","ex__21455__auto__","e23685","statearr-23686","cljs.core/seq","statearr-23687","cljs.core/first","state__21498__auto__","statearr-23688","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","cljs-http.client/get","cljs.core/rand-int","cljs.core._EQ_","js/reloadStylesheets","cljs.core/reset!","easyreagent.util/reload-css","js/setInterval","easyreagent.util/dev-reload-css","js/setTimeout","js/mode","easyreagent.util/load-page","location","js/window","easyreagent.util/write-json","clj-map","js/JSON","cljs.core/clj->js","easyreagent.util/read-json-keywordize","json-str","cljs.core.js__GT_clj","easyreagent$util$Renderable$render$dyn","x__5390__auto__","m__5391__auto__","easyreagent.util/render","goog/typeOf","m__5389__auto__","cljs.core/missing-protocol","easyreagent.util/Renderable","this","easyreagent.util/post-redirect","path","params","form","js/document","seq__23689","chunk__23690","count__23691","i__23692","vec__23699","cljs.core.nth","temp__5823__auto__","cljs.core/chunked-seq?","c__5565__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","vec__23702","cljs.core/next","k","v","input","cljs.core/name","easyreagent.util/decode-html-entities-manual","s","clojure.string/replace","easyreagent.util/get-server-side-data","meta-el","content","js/JSON.parse"],"sourcesContent":["(ns easyreagent.util\n  (:require-macros [easyreagent.util])\n  (:require\n   [clojure.browser.dom :as dom]\n   [cljs.reader :as reader]\n   [cljs.core.async :refer [<!]]\n   [cljs-http.client :as http]))\n\n(def curr-css (atom nil))\n\n(defn reload-stylesheets []\n  (cljs.core.async.macros/go\n    (let [output (:body (<! (http/get (str \"resources/global_output.css?v=\" (rand-int 1000000)))))]\n      (when (not (= @curr-css output))\n        (js/reloadStylesheets))\n      (reset! curr-css output))))\n\n(defn reload-css []\n  (js/setInterval\n   (fn [] (reload-stylesheets)) 500))\n\n\n(defn dev-reload-css []\n  (js/setTimeout (fn []\n                 (when (= js/mode \"dev\")\n                   (reload-css)))\n               3000))\n(defn load-page [location]\n  (set! (.-href (.-location js/window)) location))\n  \n(defn write-json [clj-map]\n  (.stringify js/JSON (clj->js clj-map)))\n\n(defn read-json-keywordize [json-str]\n  (js->clj (.parse js/JSON json-str) :keywordize-keys true))\n\n\n(defprotocol Renderable\n  (render [this]))\n\n\n(defn post-redirect [path params]\n  (let [form (.createElement js/document \"form\")]\n    (set! (.-method form) \"POST\")\n    (set! (.-action form) path)\n    (set! (.-style form) \"display: none;\") ; optional: hide the form\n\n    ;; Create hidden input fields from params\n    (doseq [[k v] params]\n      (let [input (.createElement js/document \"input\")]\n        (set! (.-type input) \"hidden\")\n        (set! (.-name input) (name k))\n        (set! (.-value input) (str v)) ; ensure value is a string\n        (.appendChild form input)))\n\n    ;; Append form and submit\n    (.appendChild (.-body js/document) form)\n    (.submit form)))\n\n(defn- decode-html-entities-manual [s]\n  (-> s\n      (clojure.string/replace \"&quot;\" \"\\\"\")\n      (clojure.string/replace \"&apos;\" \"'\")\n      (clojure.string/replace \"&lt;\" \"<\")\n      (clojure.string/replace \"&gt;\" \">\")\n      (clojure.string/replace \"&amp;\" \"&\")))\n\n(defn get-server-side-data []\n  (when-let [meta-el (.querySelector js/document \"meta[id='global-easyreagent-metadata']\")]\n    (when-let [content (.getAttribute meta-el \"server-data\")]\n      (js->clj (js/JSON.parse (decode-html-entities-manual content)) :keywordize-keys true))))\n;; (get-serverside-data)\n"]}