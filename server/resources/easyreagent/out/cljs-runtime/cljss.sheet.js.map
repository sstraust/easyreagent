{"version":3,"sources":["cljss/sheet.cljs"],"mappings":"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","names":["cljss.sheet/limit","cljss.sheet/make-style-tag","tag","goog.dom/createElement","head","goog.dom/getElementsByTagNameAndClass","cljss.sheet.goog$module$goog$object.set","goog.dom/appendChild","goog.dom/createTextNode","cljss$sheet$ISheet$insert_BANG_$dyn","x__5390__auto__","m__5391__auto__","cljss.sheet/insert!","goog/typeOf","m__5389__auto__","cljs.core/missing-protocol","cljss$sheet$ISheet$flush_BANG_$dyn","cljss.sheet/flush!","cljss$sheet$ISheet$filled_QMARK_$dyn","cljss.sheet/filled?","cljss.sheet/ISheet","this","css","cls-name","cljs.core/PROTOCOL_SENTINEL","this__5327__auto__","writer__5328__auto__","opt__5329__auto__","cljs.core/-write","cljss.sheet/Sheet","cljss.sheet/->Sheet","sheet","cache","rule","js/Error","fexpr__28021","cljs.core/deref","cljs.core.swap_BANG_","cljs.core/conj","cljs.core/ifn?","rules-count","cljss.sheet.goog$module$goog$object.get","cljss.utils/dev?","e28022","e","js/console.warn","cljs.core._EQ_","cljs.core/count","cljss.sheet/create-sheet","cljs.core.atom"],"sourcesContent":["(ns cljss.sheet\n  (:require [goog.object :as gobj]\n            [goog.dom :as dom]\n            [cljss.utils :refer [dev?]]))\n\n(def ^:private limit 65534)\n\n(defn- make-style-tag []\n  (let [tag (dom/createElement \"style\")\n        head (aget (dom/getElementsByTagNameAndClass \"head\") 0)]\n    (gobj/set tag \"type\" \"text/css\")\n    (dom/appendChild tag (dom/createTextNode \"\"))\n    (dom/appendChild head tag)\n    tag))\n\n\n(defprotocol ISheet\n  (insert! [this css cls-name])\n  (flush! [this])\n  (filled? [this]))\n\n(deftype Sheet [tag sheet cache]\n  ISheet\n  (insert! [this rule cls-name]\n    (when (filled? this)\n      (throw (js/Error. (str \"A stylesheet can only have \" limit \" rules\"))))\n    (when-not (@cache cls-name)\n      (swap! cache conj cls-name)\n      (let [rule (if (ifn? rule) (rule) rule)\n            rules-count (gobj/get (gobj/get sheet \"cssRules\") \"length\")]\n        (if dev?\n          (dom/appendChild tag (dom/createTextNode rule))\n          (try\n            (.insertRule sheet rule rules-count)\n            (catch :default e\n              (when dev?\n                (js/console.warn \"Illegal CSS rule\" rule))))))))\n  (flush! [this]\n    (-> tag\n        .-parentNode\n        (.removeChild tag)))\n  (filled? [this]\n    (= (count @cache) limit)))\n\n(defn create-sheet []\n  (let [tag (make-style-tag)\n        sheet (gobj/get tag \"sheet\")]\n    (Sheet. tag sheet (atom #{}))))\n"],"x_google_ignoreList":[0]}